<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Changing / creating new templates &mdash; PODIO  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=7f41d439"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Advanced Topics" href="advanced_topics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PODIO
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="doc.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.html#quick-start">Quick-start</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design and Implementation Details</a><ul>
<li class="toctree-l2"><a class="reference internal" href="design.html#layout-of-objects">Layout of Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="design.html#the-user-layer">The User Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#the-internal-data-layer">The Internal Data Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#the-pod-layer">The POD Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#the-collections">The Collections</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#vectorization-support-notebook-pattern">Vectorization support / notebook pattern</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="design.html#handling-mutability">Handling mutability</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="datamodel_syntax.html">Data Models and Data Model Definitions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="datamodel_syntax.html#basic-concepts-and-supported-features">Basic Concepts and Supported Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="datamodel_syntax.html#definition-of-custom-components">Definition of custom components</a></li>
<li class="toctree-l2"><a class="reference internal" href="datamodel_syntax.html#definition-of-custom-data-classes">Definition of custom data classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="datamodel_syntax.html#defining-members">Defining members</a></li>
<li class="toctree-l3"><a class="reference internal" href="datamodel_syntax.html#definition-of-references-between-objects">Definition of references between objects:</a></li>
<li class="toctree-l3"><a class="reference internal" href="datamodel_syntax.html#explicit-definition-of-methods">Explicit definition of methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="datamodel_syntax.html#global-options">Global options</a></li>
<li class="toctree-l2"><a class="reference internal" href="datamodel_syntax.html#extending-a-datamodel-using-types-from-an-upstream-datamodel">Extending a datamodel / using types from an upstream datamodel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="datamodel_syntax.html#potential-pitfalls">Potential pitfalls</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples for Supported Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples.html#object-ownership">Object Ownership</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#object-creation-and-storage">Object Creation and Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#object-references">Object References</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#looping-through-collections">Looping through Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#support-for-notebook-pattern">Support for Notebook-Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#podio-frame-container"><code class="docutils literal notranslate"><span class="pre">podio::Frame</span></code> container</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#object-retrieval">Object Retrieval</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#user-defined-meta-data">User defined Meta Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples.html#python-interface">Python Interface</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="frame.html">The <code class="docutils literal notranslate"><span class="pre">Frame</span></code> concept</a><ul>
<li class="toctree-l2"><a class="reference internal" href="frame.html#basic-functionality-of-a-frame">Basic functionality of a <code class="docutils literal notranslate"><span class="pre">Frame</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="frame.html#usage-examples-for-collection-data">Usage examples for collection data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="frame.html#putting-collection-data-into-the-frame">Putting collection data into the <code class="docutils literal notranslate"><span class="pre">Frame</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="frame.html#getting-collection-references-from-the-frame">Getting collection (references) from the <code class="docutils literal notranslate"><span class="pre">Frame</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="frame.html#usage-for-parameters">Usage for Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="frame.html#i-o-basics-and-philosophy">I/O basics and philosophy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="frame.html#writing-a-frame">Writing a <code class="docutils literal notranslate"><span class="pre">Frame</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="frame.html#reading-a-frame">Reading a <code class="docutils literal notranslate"><span class="pre">Frame</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="frame.html#schema-evolution">Schema evolution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="frame.html#frame-implementation-and-design">Frame implementation and design</a></li>
<li class="toctree-l1"><a class="reference internal" href="userdata.html">Writing extra data outside an EDM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="userdata.html#example-usage">Example usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="userdata.html#some-limitations">Some limitations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="userdata.html#no-relations-to-other-collections">No relations to other collections</a></li>
<li class="toctree-l3"><a class="reference internal" href="userdata.html#limited-supported-types">Limited supported types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced_topics.html">Advanced Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced_topics.html#writing-extra-data-outside-the-edm">Writing extra data outside the EDM</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_topics.html#changing-creating-new-templates">Changing / creating new templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_topics.html#persistency">Persistency</a><ul>
<li class="toctree-l3"><a class="reference internal" href="advanced_topics.html#writing-back-end">Writing Back-End</a></li>
<li class="toctree-l3"><a class="reference internal" href="advanced_topics.html#reading-back-end">Reading Back-End</a></li>
<li class="toctree-l3"><a class="reference internal" href="advanced_topics.html#dumping-json">Dumping JSON</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="advanced_topics.html#thread-safety">Thread-safety</a><ul>
<li class="toctree-l3"><a class="reference internal" href="advanced_topics.html#changing-user-data">Changing user data</a></li>
<li class="toctree-l3"><a class="reference internal" href="advanced_topics.html#serialization">Serialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="advanced_topics.html#not-thread-safe-components">Not-thread-safe components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="advanced_topics.html#running-pre-commit">Running pre-commit</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_topics.html#retrieving-the-edm-definition-from-a-data-file">Retrieving the EDM definition from a data file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="advanced_topics.html#accessing-the-edm-definition-programmatically">Accessing the EDM definition programmatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="advanced_topics.html#technical-details-on-edm-definition-embedding">Technical details on EDM definition embedding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="advanced_topics.html#the-datamodelregistry">The <code class="docutils literal notranslate"><span class="pre">DatamodelRegistry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="advanced_topics.html#i-o-helpers-for-edm-definition-storing">I/O helpers for EDM definition storing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Changing / creating new templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preprocessing-of-yaml-file">Preprocessing of yaml file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#existing-templates">Existing templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-new-template">Adding a new template</a></li>
<li class="toctree-l2"><a class="reference internal" href="#available-information-in-the-templates">Available information in the templates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-information">General information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#components">Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#datatypes">Datatypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#membervariable"><code class="docutils literal notranslate"><span class="pre">MemberVariable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#datatype"><code class="docutils literal notranslate"><span class="pre">DataType</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#julia-code-generation">Julia code generation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PODIO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Changing / creating new templates</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="changing-creating-new-templates">
<h1>Changing / creating new templates<a class="headerlink" href="#changing-creating-new-templates" title="Link to this heading"></a></h1>
<p>PODIO uses the <a class="reference external" href="https://jinja.palletsprojects.com/en/3.1.x/">Jinja2</a> template engine to generate the c++ code from the yaml description.
This document here gives an overview of how PODIO uses the Jinja2 engine and how the yaml file is processed before it is passed to it.
We don’t go into many details of Jinja2 templates here, please refer to the <a class="reference external" href="https://jinja.palletsprojects.com/en/3.1.x/templates/">Template Designer Document</a> of Jinja2.
PODIO only makes use of rather basic Jinja2 templates, so it should in principle be possible to pick up the basics just by looking at some existing templates.</p>
<section id="preprocessing-of-yaml-file">
<h2>Preprocessing of yaml file<a class="headerlink" href="#preprocessing-of-yaml-file" title="Link to this heading"></a></h2>
<p>The entry point for reading yaml files is the <a class="reference internal" href="#/python/podio_gen/podio_config_reader.py"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">python/podio_gen/podio_config_reader.py</span></code></span></a>.
When reading the yaml file a basic validation is run and the data members, relations and vector members of components and datatypes are parsed into <code class="docutils literal notranslate"><span class="pre">MemberVariable</span></code> objects (defined in <a class="reference internal" href="#/python/podio_gen/generator_utils.py"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">python/podio_gen/generator_utils.py</span></code></span></a>).
The main entry point to the code generation is the <a class="reference internal" href="#/python/podio_class_generator.py"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">python/podio_class_generator.py</span></code></span></a> which takes care of instantiating the language specific code generator (either C++ or a prototype version for Julia at this point).
The language specific generators inherit from the <a class="reference internal" href="#/python/podio_gen/generator_base.py"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">ClassGeneratorBaseMixin</span></code></span></a> which takes care of some common initialization and provides some common functionality for code generation.
In the end each langauge specific generator will take care of (either by itself or through the common functionality in <code class="docutils literal notranslate"><span class="pre">ClassGeneratorBaseMixin</span></code>):</p>
<ul class="simple">
<li><p>Configuring the Jinja2 template engine. At the moment this is mainly making the templates known to the engine.</p></li>
<li><p>The necessary preprocessing of all the datatypes and components. This includes collecting necessary include directories and forward declaration, as well as digesting <code class="docutils literal notranslate"><span class="pre">ExtraCode</span></code> snippets.</p></li>
<li><p>Putting all the necessary information into a <code class="docutils literal notranslate"><span class="pre">dict</span></code> that can be easily used in the Jinja2 templates. See <a class="reference internal" href="#available-information-in-the-templates"><span class="xref myst">below</span></a> for what is available in the templates</p></li>
<li><p>Calling the template engine to fill the necessary templates for each datatype or component and making sure to only write to disk if the filled template actually changed. Optionally run <code class="docutils literal notranslate"><span class="pre">clang-format</span></code> on them before writing.</p></li>
<li><p>Producing a list of generated c++ files for consumption by the cmake macros of PODIO.</p></li>
</ul>
<p>Currently two language specific generators are available: <a class="reference internal" href="#/python/podio_gen/cpp_generator.py"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">CPPClassGenerator</span></code></span></a> and <a class="reference internal" href="#/python/podio_gen/julia_generator.py"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">JuliaClassGenerator</span></code></span></a>.
Note that some of the information below will only apply to either of these generators as they provide the template engine with slightly different content.</p>
</section>
<section id="existing-templates">
<h2>Existing templates<a class="headerlink" href="#existing-templates" title="Link to this heading"></a></h2>
<p>Currently PODIO loads templates that are placed in <a class="reference internal" href="#/python/templates"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">&lt;prefix&gt;/python/templates</span></code></span></a>.
They are broadly split along the classes that are generated for each datatype or component from the EDM definition:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>template file(s)</p></th>
<th class="head"><p>content</p></th>
<th class="head"><p>generated file(s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Component.h.jinja2</span></code></p></td>
<td><p>Definition for each component</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]&lt;component-name&gt;.h</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Data.h.jinja2</span></code></p></td>
<td><p>POD struct of each datatype (living in the POD layer)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]&lt;datatype-name&gt;Data.h</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Obj.{h,cc}.jinja2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Obj</span></code> class for each datatype (linving in the object layer) and managing resources</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]&lt;datatype-name&gt;Obj.h</span></code>,  <code class="docutils literal notranslate"><span class="pre">src/&lt;datatype-name&gt;Obj.cc</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">[Mutable]Object.{h,cc}.jinja2</span></code></p></td>
<td><p>The user facing interfaces for each datatype (living in the user layer)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/][Mutable]&lt;datatype-name&gt;.h</span></code>, <code class="docutils literal notranslate"><span class="pre">src/[Mutable]&lt;datatype-name&gt;.cc</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Collection.{h,cc}.jinja2</span></code></p></td>
<td><p>The user facing collection interface (living in the user layer)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]&lt;datatype-name&gt;Collection.h</span></code>, <code class="docutils literal notranslate"><span class="pre">src/&lt;datatype-name&gt;Collection.cc</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">CollectionData.{h,cc}.jinja2</span></code></p></td>
<td><p>The classes managing the collection storage (not user facing!)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]&lt;datatype-name&gt;CollectionData.h</span></code>, <code class="docutils literal notranslate"><span class="pre">src/&lt;datatype-name&gt;CollectionData.cc</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">selection.xml.jinja2</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">selection.xml</span></code> file that is necessary for generating a root dictionary for the generated datamodel</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">src/selection.xml</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SIOBlock.{h,cc}.jinja2</span></code></p></td>
<td><p>The SIO blocks that are necessary for the SIO backend</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]&lt;datatype-name&gt;SIOBlock.h</span></code>, <code class="docutils literal notranslate"><span class="pre">src/&lt;datatype-name&gt;SIOBlock.cc</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MutableStruct.jl.jinja2</span></code></p></td>
<td><p>The mutable struct definitions of components and datatypes for julia</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]&lt;datatype-name&gt;Struct.jl</span></code>, <code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]&lt;component-name&gt;Struct.jl</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ParentModule.jl.jinja2</span></code></p></td>
<td><p>The constructor and collection definitions of components and datatypes in the data model are contained within a single module named after the package-name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]&lt;package-name&gt;.jl</span></code></p></td>
</tr>
</tbody>
</table>
<p>The presence of a <code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;]</span></code> subdirectory for the header files is controlled by the <code class="docutils literal notranslate"><span class="pre">includeSubfolder</span></code> option in the yaml definition file.</p>
<p>Jinja allows the definition of additional macros and supports importing them similar to python modules.
These are stored in the <a class="reference internal" href="#/python/templates/macros"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">macros</span></code></span></a> subfolder and are imported directly by the main templates where necessary.</p>
</section>
<section id="adding-a-new-template">
<h2>Adding a new template<a class="headerlink" href="#adding-a-new-template" title="Link to this heading"></a></h2>
<p>All templates that are placed in the templates directory mentioned <a class="reference internal" href="#existing-templates"><span class="xref myst">above</span></a> become immediately available to the template engine if it ends on <code class="docutils literal notranslate"><span class="pre">.jinja2</span></code>
However, it is still necessary to actively fill them from the class generator.
If the available information for the new templates is already enough and no further pre-processing is necessary, than they need to be added to <code class="docutils literal notranslate"><span class="pre">_get_filenames_templates</span></code> function in the <code class="docutils literal notranslate"><span class="pre">ClassGeneratorBaseMixin</span></code>.
The <code class="docutils literal notranslate"><span class="pre">prefix</span></code> and <code class="docutils literal notranslate"><span class="pre">postfix</span></code> dictionaries define how the template filename will be mapped to the generated files: <code class="docutils literal notranslate"><span class="pre">&lt;prefix&gt;&lt;template-filename&gt;&lt;postfix&gt;</span></code>.
By default a <code class="docutils literal notranslate"><span class="pre">.h</span></code> and a <code class="docutils literal notranslate"><span class="pre">.cc</span></code> file will be generated, but this can be overridden by adding the template to the <code class="docutils literal notranslate"><span class="pre">endings</span></code> dictionary.
With that in place it is now only neccessary to call <code class="docutils literal notranslate"><span class="pre">_fill_templates</span></code> with the appropriate template name and the pre processed data.
Note that for most templates this means that they have to be filled for each datatype or component individually.</p>
<p>If additional preprocessing is necessary, it will be necessary to also add that to the the language specific generators.
The main entry point to the generation is the <code class="docutils literal notranslate"><span class="pre">process</span></code> method which essentially just delegates to other methods.</p>
</section>
<section id="available-information-in-the-templates">
<h2>Available information in the templates<a class="headerlink" href="#available-information-in-the-templates" title="Link to this heading"></a></h2>
<p>The following gives an overview of the information that is available from the dictionary that is passed to the templates from the different
Each (top level) key in this dict is directly available as a variable in the Jinja2 templates, e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">component</span><span class="p">[</span><span class="s1">&#39;includes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="c1"># list of includes</span>
</pre></div>
</div>
<p>will become available as</p>
<div class="highlight-jinja2 notranslate"><div class="highlight"><pre><span></span>{% for include in includes %}
{{ include }}
{% endfor %}
</pre></div>
</div>
<p><strong>Be aware that some of the information is only available for the language
specific generators</strong>. The following information mostly applies to the c++ code
generation!</p>
<section id="general-information">
<h3>General information<a class="headerlink" href="#general-information" title="Link to this heading"></a></h3>
<p>The following keys / variables are always available</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key / variable name</p></th>
<th class="head"><p>content</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">package_name</span></code></p></td>
<td><p>The package name of the datamodel (passed to the generator as argument)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">use_get_syntax</span></code></p></td>
<td><p>The value of the <code class="docutils literal notranslate"><span class="pre">getSyntax</span></code> option from the yaml definition file</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">incfolder</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">[&lt;package&gt;/]</span></code> part of the generated header files (See <a class="reference internal" href="#existing-templates"><span class="xref myst">above</span></a>)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="components">
<h3>Components<a class="headerlink" href="#components" title="Link to this heading"></a></h3>
<p>The following keys are filled for each component</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key / variable</p></th>
<th class="head"><p>content</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">class</span></code></p></td>
<td><p>The class of the component  as <code class="docutils literal notranslate"><span class="pre">DataType</span></code> (see <a class="reference internal" href="#datatype"><span class="xref myst">below</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Members</span></code></p></td>
<td><p>The members of the component as <code class="docutils literal notranslate"><span class="pre">MemberVariable</span></code>s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">includes</span></code></p></td>
<td><p>All the necessary includes for this component</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ExtraCode</span></code></p></td>
<td><p>Optionally present extra code</p></td>
</tr>
</tbody>
</table>
</section>
<section id="datatypes">
<h3>Datatypes<a class="headerlink" href="#datatypes" title="Link to this heading"></a></h3>
<p>The following keys / variables are filled for each datatype</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key / variable</p></th>
<th class="head"><p>content</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">class</span></code></p></td>
<td><p>The (immutable, user-facing) class as <code class="docutils literal notranslate"><span class="pre">DataType</span></code> (see <a class="reference internal" href="#datatype"><span class="xref myst">below</span></a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Members</span></code></p></td>
<td><p>The members of the datatype as a list of <code class="docutils literal notranslate"><span class="pre">MemberVariable</span></code>s (see <a class="reference internal" href="#membervariable"><span class="xref myst">below</span></a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">OneToOneRelations</span></code></p></td>
<td><p>The one-to-one relation members of the datatype as  a list of <code class="docutils literal notranslate"><span class="pre">MemberVariable</span></code>s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">OneToManyRelations</span></code></p></td>
<td><p>The one-to-many relation members of the datatype as a list of <code class="docutils literal notranslate"><span class="pre">MemberVariable</span></code>s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">VectorMembers</span></code></p></td>
<td><p>The vector members of the datatype as a list of <code class="docutils literal notranslate"><span class="pre">MemberVariable</span></code>s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">includes</span></code></p></td>
<td><p>The include directives for the the user facing classes header files</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">includes_cc</span></code></p></td>
<td><p>The include directives for the implemenations of the user facing classes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">includes_data</span></code></p></td>
<td><p>The necessary include directives for the <code class="docutils literal notranslate"><span class="pre">Data</span></code> POD types</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">includes_obj</span></code></p></td>
<td><p>The include directives for the <code class="docutils literal notranslate"><span class="pre">Obj</span></code> classes headers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">includes_cc_obj</span></code></p></td>
<td><p>The include directives for the implementation files of the <code class="docutils literal notranslate"><span class="pre">Obj</span></code> classes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">includes_coll_cc</span></code></p></td>
<td><p>The include directives for the implementation of the <code class="docutils literal notranslate"><span class="pre">Collection</span></code> classes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">include_coll_data</span></code></p></td>
<td><p>The include directives for the header <code class="docutils literal notranslate"><span class="pre">CollectionData</span></code> header file</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">forward_declarations</span></code></p></td>
<td><p>The forward declarations for the user facing classes header files. This is a nested dict, where the keys are namespaces and the leaf values are classes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">forward_declarations_obj</span></code></p></td>
<td><p>The forward declarations for the <code class="docutils literal notranslate"><span class="pre">Obj</span></code> classes header files.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">is_pod</span></code></p></td>
<td><p>Flag value indicating whether the <code class="docutils literal notranslate"><span class="pre">Data</span></code> class of this datatype is a POD or if it contains an STL member</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">is_trivial_type</span></code></p></td>
<td><p>Flag that indicates that this is a <em>trivial</em> data type, i.e. one without relations or vector members.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ostream_collection_settings</span></code></p></td>
<td><p>A dict with a single <code class="docutils literal notranslate"><span class="pre">header_contents</span></code> key that is necessary for the output stream overload implementation of collections</p></td>
</tr>
</tbody>
</table>
</section>
<section id="membervariable">
<h3><code class="docutils literal notranslate"><span class="pre">MemberVariable</span></code><a class="headerlink" href="#membervariable" title="Link to this heading"></a></h3>
<p>Defined in <a class="reference internal" href="#/python/generator_utils.py"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">python/generator_utils.py</span></code></span></a>.
The string representation gives the definition of the member, including a potentially present description string.
In principle all members are accessible in the templates, however, the most important ones are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>field</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></td>
<td><p>The name of the member</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">namespace</span></code></p></td>
<td><p>The (potentially empty) namespace of the member</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bare_type</span></code></p></td>
<td><p>The type of the member without namespace</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">full_type</span></code></p></td>
<td><p>The full, namespace qualified, type of the member, essentially <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">namespace</span> <span class="pre">}}::{{</span> <span class="pre">bare_type</span> <span class="pre">}}</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">description</span></code></p></td>
<td><p>The (optional) description string of the member</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">is_builtin</span></code></p></td>
<td><p>Flag for indicating that a member is a builtin type</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">is_array</span></code></p></td>
<td><p>Flag for indicating that a member is a <code class="docutils literal notranslate"><span class="pre">std::array</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">array_type</span></code></p></td>
<td><p>The type of the array if the member is a <code class="docutils literal notranslate"><span class="pre">std::array</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">array_size</span></code></p></td>
<td><p>The size of the array if the member is a <code class="docutils literal notranslate"><span class="pre">std::array</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">getter_name</span></code></p></td>
<td><p>Method for generating the correct name for getter functions, depending on the <code class="docutils literal notranslate"><span class="pre">getSyntax</span></code> option in the yaml definition file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">setter_name</span></code></p></td>
<td><p>Method for generating the correct name for setter functions, depending on the <code class="docutils literal notranslate"><span class="pre">getSyntax</span></code> option in the yaml definition file and on whether the member is a relation or not</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">signature</span></code></p></td>
<td><p>The signature of a data member that can be used in function signatures, corresponds to <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">full_type</span> <span class="pre">}}</span> <span class="pre">{{</span> <span class="pre">name</span> <span class="pre">}}</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">jl_imports</span></code></p></td>
<td><p>Import required for <code class="docutils literal notranslate"><span class="pre">StaticArrays:</span> <span class="pre">MVector</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">julia_type</span></code></p></td>
<td><p>Equivalent julia type for the c++ type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="datatype">
<h3><code class="docutils literal notranslate"><span class="pre">DataType</span></code><a class="headerlink" href="#datatype" title="Link to this heading"></a></h3>
<p>Defined in <a class="reference internal" href="#/python/generator_utils.py"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">python/generator_utils.py</span></code></span></a>.
This is essenitally a stripped down version of the <code class="docutils literal notranslate"><span class="pre">MemberVariable</span></code> with the major difference being that the string representation returns the fully qualified type instead.
The available fields are</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>field</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bare_type</span></code></p></td>
<td><p>The type without the namespace</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">namespace</span></code></p></td>
<td><p>The (potentially empty) namespace</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">full_type</span></code></p></td>
<td><p>The fully qualified type, corresponding to <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">namespace</span> <span class="pre">}}::{{</span> <span class="pre">bare_type</span> <span class="pre">}}</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="julia-code-generation">
<h3>Julia code generation<a class="headerlink" href="#julia-code-generation" title="Link to this heading"></a></h3>
<p>It is an experimental feature.
Builtin types mapping in Julia</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>cpp</p></th>
<th class="head"><p>julia</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Bool</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">char</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Char</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">short</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Int16</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Int32</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UInt32</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Float32</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Float64</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">long</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Int64</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UInt64</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">long</span> <span class="pre">long</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Int64</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">long</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UInt64</span></code></p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Key4hep authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v00-99
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions"><dl>
      <dt>Versions</dt>
      <dd><a href="../docs-on-gh-pages/templates.html">docs-on-gh-pages</a></dd>
      <dd><a href="../master/templates.html">master</a></dd>
      <dd><a href="../v00-00-00/templates.html">v00-00-00</a></dd>
      <dd><a href="templates.html">v00-99</a></dd>
      <dd><a href="../v99-99-99/templates.html">v99-99-99</a></dd>
    </dl></div>
</div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>